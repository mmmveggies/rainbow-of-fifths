(this["webpackJsonprainbow-of-fifths"]=this["webpackJsonprainbow-of-fifths"]||[]).push([[0],{123:function(e,t,n){e.exports=n(212)},210:function(e,t,n){},212:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),i=n.n(c),o=n(3);function l(e,t){var n=function(){var n;return JSON.parse(null!==(n=localStorage.getItem(e))&&void 0!==n?n:JSON.stringify(t))},a=function(t){null!=t?localStorage.setItem(e,JSON.stringify(t)):localStorage.removeItem(e)},c=r.a.createContext([n(),a]);return[function(){return r.a.useContext(c)},function(e){var i=e.children,l=r.a.useState(n),u=Object(o.a)(l,2),m=u[0],s=u[1],f=r.a.useMemo((function(){return[m,function(e){a(e),s(null!==e&&void 0!==e?e:t)}]}),[m]);return r.a.createElement(c.Provider,{value:f},i)}]}var u=l("sizes",[24,4,12,4,12,16,4,20,4,16,4,16]),m=Object(o.a)(u,2),s=m[0],f=m[1],d=l("colors",["#002685","#449ADF","#4DC7FD","#4CDE77","#5E53C7","#7E77D2","#CD1E10","#FC007F","#FE79D1","#763931","#F1AB00","#FADF00"]),v=Object(o.a)(d,2),h=v[0],p=v[1],g=n(119),E=n(38),y=n.n(E);var b=n(121),j=n(120),k=n(46),O=n(7);function N(e){var t=e.children;return r.a.createElement(f,null,r.a.createElement(p,null,t))}var x=n(217),C=n(56),M=n(32),w=n(214),A=n(213),S=n(22);function T(e,t,n){return Math.min(Math.max(Math.floor(e),t),n)}var F={1:-8-2/3,3:-4-1/3,6:-9.75,8:-6.75,10:-3.25},P=function(e){return[1,3,6,8,10].includes(e)},D=function(e){return P(S.b.chroma(S.a.midiToNoteName(e)))};function L(e){var t=e.low,n=void 0===t?21:t,a=e.high,c=void 0===a?109:a,i=e.keyProps,l=e.svgProps,u=T(n,21,109),m=T(c,21,109),s=Math.max(0,m-u),f=r.a.useMemo((function(){var e=Array.from({length:s},(function(e,t){return u+t})),t=e[0],n=e[e.length-1];D(t)&&e.unshift(t-1),D(n)&&e.push(n+1);var a=e.map((function(t,n){var a=23*e.slice(0,n).filter(D).length,r=S.a.midiToNoteName(t),c=S.b.chroma(r),i=P(c);return{midi:t,offset:a,accidental:i,rect:{key:t,x:23*n-a+(i?F[c]:0),width:i?13:23,height:i?80:120}}}));return[a.filter((function(e){return!e.accidental})),a.filter((function(e){return e.accidental}))]}),[u,s]),d=Object(o.a)(f,2),v=d[0],h=d[1];return s?r.a.createElement("svg",Object.assign({},l,{viewBox:"0 0 ".concat(23*v.length," ").concat(120)}),r.a.createElement("g",{fill:"white",stroke:"black"},v.map((function(e,t){return r.a.createElement("rect",Object.assign({key:t},e.rect,null===i||void 0===i?void 0:i[e.midi]))}))),r.a.createElement("g",{fill:"black",fontSize:12,textAnchor:"middle"},v.map((function(e,t){return r.a.createElement("text",{key:e.midi,x:23*t+11.5,y:110},S.a.midiToNoteName(e.midi,{sharps:!0}))}))),r.a.createElement("g",{fill:"black",stroke:"black"},h.map((function(e,t){return r.a.createElement("rect",Object.assign({key:t,stroke:"black"},e.rect,null===i||void 0===i?void 0:i[e.midi]))})))):r.a.createElement("h1",null,"No keys in midi range: [",n,",",c,"]")}var z=function(e){return e.reduce((function(e,t){return e+t}),0)};function I(e){var t=e.svgProps,n=e.pathProps,a=s(),c=Object(o.a)(a,1)[0],i=z(c),l=2*i,u=r.a.useMemo((function(){return Array.from({length:12},(function(e,t){var n=i-z(c.slice(0,t)),a=i-z(c.slice(0,t+1));return function(e){var t=e.cX,n=e.cY,a=e.r0,r=e.r1,c=e.length,i=void 0===c?12:c,o=e.theta,l=void 0===o?Math.PI/i:o,u=2*Math.PI/i,m=Array.from({length:i},(function(e,c){return{x0:t+a*Math.sin(l+u*c),y0:n+a*Math.cos(l+u*c),x1:t+a*Math.sin(l+u*(c+1)),y1:n+a*Math.cos(l+u*(c+1)),x2:t+r*Math.sin(l+u*(c+1)),y2:n+r*Math.cos(l+u*(c+1)),x3:t+r*Math.sin(l+u*c),y3:n+r*Math.cos(l+u*c)}})),s=m.map((function(e){return["M ".concat(e.x0," ").concat(e.y0),"A ".concat(a," ").concat(a," 0 0 0 ").concat(e.x1," ").concat(e.y1),"L ".concat(e.x2," ").concat(e.y2),"A ".concat(r," ").concat(r," 0 0 1 ").concat(e.x3," ").concat(e.y3),"Z"].join("\n")}));return{points:m,paths:s}}({cX:i,cY:i,r0:n,r1:a})}))}),[i,c]);return r.a.createElement("svg",Object.assign({},t,{viewBox:"0 0 ".concat(l," ").concat(l)}),r.a.createElement("g",{stroke:"black",fill:"white",strokeWidth:"0.1"},u.map((function(e,t){var a=e.paths;return r.a.createElement("g",{key:t},a.map((function(e,a){var c,i=(t+4)%12,o=null===n||void 0===n||null===(c=n[5*a%12])||void 0===c?void 0:c[i];return r.a.createElement("path",Object.assign({key:a},o,{d:e}))})))}))))}var J=n(218),R=n(53),B=n(216),W=n(215),X=Array.from({length:12},(function(e,t){return Array.from(new Set([S.a.midiToNoteName(t,{pitchClass:!0}),S.a.midiToNoteName(t,{pitchClass:!0,sharps:!0})])).join(" / ")}));function Y(){var e=h(),t=Object(o.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-evenly"}},r.a.createElement(J.a,{onConfirm:function(){return a(void 0)},title:"Reset to default colors?"},r.a.createElement(R.a,{block:!0},"Reset Colors")),Array.from({length:12},(function(e,t){return r.a.createElement(B.a,{key:t,type:"color",size:"large",value:n[t],onChange:function(e){var r=n.slice();r[t]=e.currentTarget.value,a(r)},addonAfter:r.a.createElement(W.a.Text,{strong:!0},X[t])})})))}var G=Array.from({length:12},(function(e,t){return Array.from(new Set([S.a.midiToNoteName(t,{pitchClass:!0}),S.a.midiToNoteName(t,{pitchClass:!0,sharps:!0})])).join(" / ")}));function H(){var e=s(),t=Object(o.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-evenly"}},r.a.createElement(J.a,{onConfirm:function(){return a(void 0)},title:"Reset to default sizes?"},r.a.createElement(R.a,{block:!0},"Reset Sizes")),Array.from({length:12},(function(e,t){return r.a.createElement(B.a,{key:t,min:0,max:30,type:"number",size:"large",value:n[t],onChange:function(e){var r=e.target.value;if(""!==r){var c=n.slice();c[t]=+r,a(c)}},addonAfter:r.a.createElement(W.a.Text,{strong:!0},G[t])})})))}function Z(e){var t,n,a=function(e){var t=r.a.useState({}),n=Object(o.a)(t,2),a=n[0],c=n[1];return r.a.useEffect((function(){var t=function(e){c((function(t){return Object(O.a)(Object(O.a)({},t),{},Object(k.a)({},e.note.number,e))}))},n=function(e){c((function(t){var n=e.note.number;t[n];return Object(b.a)(t,[n].map(j.a))}))};return e.addListener("noteon","all",t),e.addListener("noteoff","all",n),function(){e.removeListener("noteon","all",t),e.removeListener("noteoff","all",n)}}),[e]),a}(e.source),c=h(),i=Object(o.a)(c,1)[0],l=new Set(Object.keys(a).map((function(e){return S.a.midiToNoteName(+e,{pitchClass:!0})}))),u=(n=function(e){return{fill:e.note.number in a?i[S.b.chroma(S.a.midiToNoteName(e.note.number))]:void 0}},(t=a)?Object.fromEntries(Object.entries(null!==t&&void 0!==t?t:{}).map((function(e){var t=Object(o.a)(e,2),a=t[0],r=t[1];return[a,n(r,a)]}))):{}),m=Array.from({length:12},(function(e,t){var n=(t+7)%12,a=S.a.midiToNoteName(n,{pitchClass:!0});return Array.from({length:12},(function(e,t){var r=(t+n)%12,c=S.a.midiToNoteName(r,{pitchClass:!0});return{name:a,midi:r,note:c,fill:l.has(c)?i[r%12]:void 0}}))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null,r.a.createElement(M.a,{span:12},r.a.createElement(I,{svgProps:{width:"100%"},pathProps:m})),r.a.createElement(M.a,{span:6},r.a.createElement(Y,null)),r.a.createElement(M.a,{span:6},r.a.createElement(H,null))),r.a.createElement(C.a,null,r.a.createElement(M.a,{span:24},r.a.createElement(L,{svgProps:{width:"100%"},keyProps:u}))))}var q=r.a.createElement(x.a,{type:"warning",message:"Please connect a midi input device"});function K(){var e=function(){var e=r.a.useState(y.a.inputs),t=Object(o.a)(e,2),n=t[0],a=t[1];return r.a.useEffect((function(){var e=function(e){var t=e.port;"input"===t.type&&a((function(e){var n=e.filter((function(e){return e.id!==t.id}));return[].concat(Object(g.a)(n),[t])}))},t=function(e){var t=e.port;a((function(e){var n=e.filter((function(e){return e.id!==t.id}));return e.length===n.length?e:n}))};return y.a.addListener("connected",e),y.a.addListener("disconnected",t),function(){y.a.removeListener("connected",e),y.a.removeListener("disconnected",t)}}),[]),n}();return r.a.createElement(N,null,r.a.createElement(C.a,{align:"middle",gutter:8},r.a.createElement(M.a,null,r.a.createElement("h1",null,"Rainbow of Fifths")),r.a.createElement(M.a,null,r.a.createElement("a",{href:"https://github.com/mmmveggies/rainbow-of-fifths"},"view source or give feedback on GitHub"))),e.length?e.map((function(e){return r.a.createElement(w.a,{key:e.id,title:r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,e.name,r.a.createElement(A.a,{type:"vertical"}),e.manufacturer,r.a.createElement(A.a,{type:"vertical"}),e.id))},r.a.createElement(Z,{source:e}))})):q)}n(210),n(211);var Q=function(e){i.a.render(e,document.getElementById("root"))};y.a.enable((function(e){Q(e?r.a.createElement(x.a,{type:"error",message:"Fatal WebMidi Error",description:r.a.createElement("code",null,r.a.createElement("pre",null,JSON.stringify(e,null,2)))}):r.a.createElement(r.a.StrictMode,null,r.a.createElement(K,null)))}))}},[[123,1,2]]]);
//# sourceMappingURL=main.e9177039.chunk.js.map